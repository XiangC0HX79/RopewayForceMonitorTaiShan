<?xml version="1.0" encoding="utf-8"?>
<s:Group xmlns:fx="http://ns.adobe.com/mxml/2009" 
		 xmlns:s="library://ns.adobe.com/flex/spark" 
		 xmlns:mx="library://ns.adobe.com/flex/mx" 
		 width="60">
	<fx:Script>
		<![CDATA[
			import spark.events.TextOperationEvent;
			
			import flashx.textLayout.operations.CompositeOperation;
			import flashx.textLayout.operations.InsertTextOperation;
			
			protected function textHour_changeHandler(event:TextOperationEvent):void
			{
				if(event.operation is InsertTextOperation)
				{
					if(textHour.text.length == 2)
					{
						textMin.setFocus();
					}
				}
				else if(event.operation is CompositeOperation)
				{
					
					var operation:CompositeOperation = event.operation as CompositeOperation;
					if(operation.operations[operation.operations.length - 1] is InsertTextOperation)
					{
						if(textHour.text.length == 2)
						{
							textMin.setFocus();
						}
					}
				}
			}
			
			protected function textHour_focusOutHandler(event:FocusEvent):void
			{
				var n:Number = Number(textHour.text);
				if(n > 23)textHour.text = "23";
			}
			
			protected function textMin_focusOutHandler(event:FocusEvent):void
			{
				var n:Number = Number(textMin.text);
				if(n > 59)textMin.text = "59";
			}
			
			private function Number2String(n:Number):String
			{
				var s:String = String(n);
				return (s.length == 1)?"0" + s:s;
			}
			
			[Bindable]
			public function get time():String
			{
				if((!textHour.text) && (!textMin.text))
					return "";
					
				var hour:Number = Number(textHour.text);
				if(hour > 23)hour = 23;
				
				var min:Number = Number(textMin.text);
				if(min > 59)min = 59;
				
				return Number2String(hour) + ":" + Number2String(min);
			}
			
			public function set time(value:String):void
			{				
				var s:Array = value.split(":");
				
				var hour:String = s[0];
				var min:String = "";
				if(s.length > 1)min = s[1];
								
				var n:Number = Math.min(23,Number(hour));
				if(isNaN(n) || (n == 0))
				{
					textHour.text = ""
				}
				else
				{
					textHour.text = Number2String(n);
				}
								
				var m:Number = Math.min(59,Number(min));
				if(isNaN(m) || (m == 0))
				{
					textMin.text = ""
				}
				else
				{
					textMin.text = Number2String(m);
				}
			}
		]]>
	</fx:Script>
	<fx:Declarations>
		<!-- 将非可视元素（例如服务、值对象）放在此处 -->
	</fx:Declarations>
	
	<s:Rect left="0" right="0" top="0" bottom="0">
		<s:fill>
			<s:SolidColor color="white"/>
		</s:fill>
		<s:stroke>
			<s:SolidColorStroke color="0"/>
		</s:stroke>
	</s:Rect>
	
	<s:HGroup left="2" right="2" top="2" bottom="2" verticalAlign="middle">		
		<s:TextInput id="textHour" width="100%" height="100%" textAlign="center"
					 borderVisible="false" restrict="0-9" 
					 change="textHour_changeHandler(event)" 
					 focusOut="textHour_focusOutHandler(event)"/>
		<s:Label text=":"/>
		<s:TextInput id="textMin" width="100%" height="100%" textAlign="center"
					 borderVisible="false" restrict="0-9" 
					 focusOut="textMin_focusOutHandler(event)"/>
	</s:HGroup>
</s:Group>
