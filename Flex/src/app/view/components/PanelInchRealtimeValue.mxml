<?xml version="1.0" encoding="utf-8"?>
<s:SkinnableContainer xmlns:fx="http://ns.adobe.com/mxml/2009" 
		 xmlns:s="library://ns.adobe.com/flex/spark" 
		 xmlns:mx="library://ns.adobe.com/flex/mx"
		 skinClass="custom.skin.SkinPanel" height="100%" width="100%" 
		 resize="container_resizeHandler(event)" fontWeight="bold">
	<fx:Script>
		<![CDATA[
			import flash.utils.setTimeout;
			
			import mx.events.ResizeEvent;
			
			import app.model.vo.InchVO;
			import app.model.vo.InchValueVO;
						
			private const MAX_VALUE:Number = 1000;
			private const MIN_VALUE:Number = 0;
			private const IMG_WIDTH:Number = 851;
			private const IMG_MAX:Number = 826;
			private const IMG_MIN:Number = 5;
			
			[Bindable]private var inchValue:Number;
			
			[Bindable]private var aveDay:Number;			
			[Bindable]private var aveMon:Number;			
			[Bindable]private var aveThreeMon:Number;
			
			[Bindable]private var periodAveDay:Number;
			[Bindable]private var periodAveMon:Number;
			[Bindable]private var periodAveThreeMon:Number;
			
			private var _inch:InchVO;
			
			public function get inch():InchVO
			{
				return _inch;
			}
			public function set inch(value:InchVO):void
			{
				_inch = value;
				
				inchValue = _inch.lastValue?_inch.lastValue.value:0;
				
				aveDay = Math.round(_inch.aveDay * 10) / 10;
				aveMon = _inch.aveMon;
				aveThreeMon = _inch.aveThreeMon;
								
				periodAveDay = _inch.periodAveDay;
				periodAveMon = _inch.periodAveMon;
				periodAveThreeMon = _inch.periodThreeMon;
				
				drawNiddle();
			}
			
			protected function container_resizeHandler(event:ResizeEvent):void
			{
				flash.utils.setTimeout(drawNiddle,200);
			}
			
			private function drawNiddle():void
			{	
				var value:Number = inchValue;
				if(value > MAX_VALUE)value = MAX_VALUE;
				if(value < MIN_VALUE)value = MIN_VALUE;
				
				var grad:Number = (value - MIN_VALUE) / (MAX_VALUE - MIN_VALUE) * (IMG_MAX - IMG_MIN) + IMG_MIN;				
				grad *= img.width / IMG_WIDTH;
				grad -= niddle.width / 2;
				
				m.xTo = grad;
				m.end();
				m.play([niddle]);
			}
		]]>
	</fx:Script>
	
	<fx:Declarations>
		<!-- 将非可视元素（例如服务、值对象）放在此处 -->
		<s:Move id="m"/>
	</fx:Declarations>
	
	<s:HGroup left="30" right="20" height="24" verticalAlign="middle" color="0x1b5aa2">
		<s:Label text="张紧小尺"/>
	</s:HGroup>
	
	<s:VGroup id="niddle" y="35" horizontalAlign="center" gap="0" width="40">
		<s:Label text="{inchValue}M"/>
		<s:Image source="assets/image/inch_niddle.png"/>		
	</s:VGroup>
	
	<s:Image id="img" left="0" right="0" y="75" height="50" source="assets/image/back_inch.png" scaleMode="stretch"/>
	
	<s:HGroup width="100%" y="125">
		<s:Spacer width="100%"/>
		
		<s:VGroup>
			<s:Label text="今天平均"/>
			<s:Label text="同期平均"/>			
		</s:VGroup>
				
		<s:VGroup>
			<s:Label text="{aveDay}"/>
			<s:Label text="{periodAveDay}"/>			
		</s:VGroup>
		
		<s:Spacer width="100%"/>
				
		<s:VGroup>
			<s:Label text="本月平均"/>
			<s:Label text="同期月平均"/>			
		</s:VGroup>
		
		<s:VGroup>
			<s:Label text="{aveMon}"/>
			<s:Label text="{periodAveMon}"/>			
		</s:VGroup>
		
		<s:Spacer width="100%"/>
		
		<s:VGroup>
			<s:Label text="三个月平均"/>
			<s:Label text="同期三月平均"/>			
		</s:VGroup>
		
		<s:VGroup>
			<s:Label text="{aveThreeMon}"/>
			<s:Label text="{periodAveThreeMon}"/>			
		</s:VGroup>
		
		<s:Spacer width="100%"/>
	</s:HGroup>
</s:SkinnableContainer>
